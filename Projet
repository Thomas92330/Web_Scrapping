from selenium import webdriver
from bs4 import BeautifulSoup as soup
from datetime import datetime
from time import sleep
import pandas as pd

def get_bitcoin():
    d = webdriver.Chrome("D:\chromedriver.exe")
    d.get('https://www.boursorama.com/bourse/devises/taux-de-change-bitcoin-euro-BTC-EUR/')
    soupy = soup(d.page_source, 'html.parser')
    
    element = soupy.find_all("span", {"class":"c-quote-chart-info-area__value"})
    
    ouv = element[0].getText() 
    high = element[1].getText()  
    low = element[2].getText()  
    last = element[3].getText()  
    var = element[4].getText() 
    vol = element[5].getText()  
    time_bitcoin = datetime.now()
    
    list_returned = [ouv,high,low,last,var,vol,time_bitcoin]
    d.quit()
    return list_returned


list_bitcoin = []
column_names = ["ouv","high","low","last","var","vol",'time']

for i in range(3):
    bitcoin = get_bitcoin()
    list_bitcoin.append(bitcoin)
    print(bitcoin)
    sleep(60)
print(list_bitcoin)
df = pd.DataFrame(list_bitcoin,columns = column_names)
df.to_csv()
